# Course Spider

之前用于[Course Helper](https://github.com/LiYingwei/courseHelper)采集每学期开课数据的小工具。

## 原理

从之前某学期开始，选课系统因为服务器不堪重负而限制了课程搜索的最短字符串（搜索栏至少要填6位选课号才能搜索），因此不能通过一次请求返回所有开课数据，手动抓数据很麻烦。

但由于所有选课号的6位公共前缀数量很有限，所以我们可以从AllCourses.txt信息中找到所有合法的前缀，再在选课系统中枚举这些前缀进行搜索，得到的查询结果取并集则是本学期开设的所有课程。

## 使用方法

直接在[选课内课程表页面](http://xk.fudan.edu.cn/xk/stdElectCourse!defaultPage.action)的Console里运行Searcher.js，用JSON.stringify(finaldata)输出全部开课数据，包括考试时间等等。

## 如何更新AllCourses.txt

只有在复旦大学设立新的专业等罕见情况发生时，会产生新的选课号前缀。所以一般而言不用更新。

不过如果一定要更新的话，请去复旦教务服务（jwfw.fudan.edu.cn）中的“学分转换申请里”找到一个填写“转换后选课号”的表单。每次在这个表单中打字会在后台进行一次搜索课程号的请求。在Network面板中找到这个请求，并且把返回结果条目数改成99999999，重新发这个请求，就可以获得复旦大学所有曾经开过的课的选课号。

之后再用Generator.js更新所有6位前缀信息，再更新Searcher.js即可。

以上方法仅对这个接口未封堵时有效，如果封堵了的话，就试试别的方法吧。

## 其他

没有包括部分二专课程（选课号以数字开头）。
